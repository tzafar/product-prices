package com.birlasoft.priceservice.services;

import com.birlasoft.priceservice.domain.Product;
import com.birlasoft.priceservice.domain.ProductResponse;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.ObjectReader;
import oracle.jrockit.jfr.openmbean.ProducerDescriptorType;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.io.IOException;
import java.util.List;

@RunWith(SpringJUnit4ClassRunner.class)
public class PriceServiceTest {
    @Test
    public void testUnwrapping() throws IOException {
        //String json = "{\"products\":[{\"productId\":\"1\",\"title\":\"A\",\"nowPrice\":\"'£13.3'\"},{\"productId\":\"1\",\"title\":\"B\",\"nowPrice\":\"'£13.3'\"}]}";
        String json ="{\"products\":[{\"productId\":\"3467432\",\"type\":\"product\",\"title\":\"Boden Rosamund Posy Stripe Dress\",\"code\":\"50851776\",\"averageRating\":0,\"reviews\":0,\"price\":{\"was\":\"90.00\",\"then1\":\"\",\"then2\":\"\",\"now\":\"63.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003410039?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Reduced to clear\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"Reduced to clear\",\"customPromotionalMessage\":\"Exclusive to John Lewis & Boden\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237334043\",\"colorSwatches\":[{\"color\":\"Navy\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003410039alt3?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003410039?\",\"isAvailable\":true,\"skuId\":\"237334043\"},{\"color\":\"Mimosa Yellow\",\"basicColor\":\"Yellow\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003410038alt3?cropN=0.4105263157894737,0.5410526315789473,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003410038?\",\"isAvailable\":true,\"skuId\":\"237334029\"}],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"Boden\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Machine washable\",\"dressbyoccasion\":\"Weekend\",\"dressshape\":\"Flared\",\"typeofpattern\":\"Floral\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0},{\"productId\":\"3525199\",\"type\":\"product\",\"title\":\"hush Kaia Dress, Black\",\"code\":\"44452343\",\"averageRating\":4,\"reviews\":2,\"price\":{\"was\":\"\",\"then1\":\"\",\"then2\":\"\",\"now\":\"65.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519464?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Exclusive to John Lewis & hush\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"\",\"customPromotionalMessage\":\"Exclusive to John Lewis & hush\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237494344\",\"colorSwatches\":[],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"hush\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Machine washable\",\"dressbyoccasion\":\"Weekend\",\"dressshape\":\"Shirt\",\"typeofpattern\":\"Plain\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0},{\"productId\":\"3525471\",\"type\":\"product\",\"title\":\"hush Aria Embroidered Dress, White\",\"code\":\"44452426\",\"averageRating\":4.4286,\"reviews\":14,\"price\":{\"was\":\"\",\"then1\":\"\",\"then2\":\"\",\"now\":\"120.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519496?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Exclusive to John Lewis & hush\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"\",\"customPromotionalMessage\":\"Exclusive to John Lewis & hush\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237494539\",\"colorSwatches\":[],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"hush\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"dryinginstructions\":\"Do not tumble dry\",\"washinginstructions\":\"Machine washable\",\"dressbyoccasion\":\"Holiday\",\"dressshape\":\"Flared\",\"typeofpattern\":\"Plain\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0}]}";
        ObjectMapper mapper = new ObjectMapper();
        ProductResponse products = mapper.readValue(json, ProductResponse.class);
        int a = 19;
       // Assert.assertThat(products, contains(customer("hello@world.com"), customer("john.doe@example.com")));
    }
}
